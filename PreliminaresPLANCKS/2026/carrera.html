---
layout: null
---
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrera de Popularidad</title>
    <!-- Estilos CSS (Tailwind) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fuentes -->
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS PURO */
        body { font-family: 'Nunito', sans-serif; background-color: transparent; }
        h1, h2 { font-family: 'Fredoka One', cursive; }
        .track-surface {
            background-color: #ef4444;
            background-image: repeating-linear-gradient(90deg, transparent, transparent 99px, rgba(255,255,255,0.4) 100px);
            border: 4px solid #b91c1c;
        }
        .runner { transition: left 1.5s cubic-bezier(0.34, 1.56, 0.64, 1); }
        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="p-2">

    <!-- 
      ========================================
      ZONA DE DATOS (JEKYLL / LIQUID)
      ========================================
      Jekyll escribe los datos aqu칤 como atributos HTML invisibles.
      JavaScript NO se mezcla aqu칤.
      Ruta de datos: _data/PreliminaresPLANCKS/data2026/carrera.yml
    -->
    <div id="data-source" style="display: none;">
        {% assign datos = site.data.PreliminaresPLANCKS.data2026.carrera %}
        {% if datos %}
            {% for equipo in datos %}
                <!-- Cada equipo es un elemento HTML simple -->
                <span class="team-data" 
                      data-id="{{ equipo.id }}" 
                      data-nombre="{{ equipo.nombre }}" 
                      data-imagen="{{ equipo.imagen }}" 
                      data-inscritos="{{ equipo.inscritos | default: 0 }}">
                </span>
            {% endfor %}
        {% endif %}
    </div>

    <!-- 
      ========================================
      ZONA VISUAL (HTML PURO)
      ========================================
    -->
    <div class="max-w-4xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-4">
            
            <!-- PISTA -->
            <div class="lg:col-span-3 shadow-xl rounded-xl overflow-hidden relative">
                <div class="bg-red-800 text-white p-2 flex justify-between items-center px-4 border-b-2 border-red-900 z-10 relative">
                    <span class="font-bold text-sm uppercase tracking-wider">游끠 Carrera de Equipos</span>
                    <span id="global-counter" class="bg-red-900 px-2 py-0.5 rounded text-xs font-mono text-yellow-300 border border-red-700">
                        Calculando...
                    </span>
                </div>

                <div class="track-surface relative p-4 h-[350px] flex flex-col justify-center">
                    <div class="absolute right-8 top-0 bottom-0 w-4 border-r-4 border-white z-0 flex flex-col justify-center items-center">
                        <div class="h-full border-r-2 border-dashed border-white opacity-50"></div>
                        <span class="absolute -bottom-6 text-red-800 font-bold text-xs">TOTAL</span>
                    </div>

                    <!-- Contenedor vac칤o donde JS pintar치 los corredores -->
                    <div id="runners-container" class="relative w-full h-full"></div>
                </div>
            </div>

            <!-- CLASIFICACI칍N -->
            <div class="bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden h-fit">
                <div class="bg-gray-800 p-2 text-white font-bold text-center text-xs uppercase">
                    游늵 Cuota de Equipo
                </div>
                <div class="p-2">
                    <ul id="leaderboard" class="space-y-1 text-sm"></ul>
                </div>
            </div>
        </div>
    </div>

    <!-- 
      ========================================
      ZONA DE L칍GICA (JAVASCRIPT PURO)
      ========================================
      Aqu칤 NO hay ning칰n c칩digo de Jekyll. Solo JavaScript est치ndar.
    -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 1. LEER LOS DATOS DEL HTML
            // Buscamos los elementos <span> ocultos que gener칩 Jekyll arriba
            const dataElements = document.querySelectorAll('.team-data');
            
            // Validaci칩n simple
            if (dataElements.length === 0) {
                document.getElementById('leaderboard').innerHTML = 
                    '<li class="text-red-500 text-xs text-center p-2">丘멆잺 No se encontraron datos.<br>Revisar ruta: _data/PreliminaresPLANCKS/data2026/carrera.yml</li>';
                return;
            }

            // 2. CONVERTIR HTML A OBJETOS JS
            let raceData = [];
            let grandTotal = 0;

            dataElements.forEach(el => {
                // Leemos los atributos 'data-' seguros
                const inscritos = parseInt(el.getAttribute('data-inscritos')) || 0;
                grandTotal += inscritos;
                
                raceData.push({
                    id: el.getAttribute('data-id'),
                    nombre: el.getAttribute('data-nombre'),
                    imagen: el.getAttribute('data-imagen'),
                    inscritos: inscritos
                });
            });

            // Actualizar texto del total
            document.getElementById('global-counter').innerText = `Total Inscritos: ${grandTotal}`;

            // 3. EJECUTAR LA ANIMACI칍N
            renderRace(raceData, grandTotal);
        });

        function renderRace(data, totalGlobal) {
            const trackContainer = document.getElementById('runners-container');
            const leaderboardContainer = document.getElementById('leaderboard');
            
            let runnersHtml = '';
            let leaderboardData = [];
            
            const totalRunners = data.length;
            const availableHeight = 85; 
            const step = totalRunners > 1 ? availableHeight / (totalRunners - 1) : 0;

            data.forEach((item, index) => {
                let percentage = 0;
                let ratio = 0;
                
                if (totalGlobal > 0) {
                    ratio = item.inscritos / totalGlobal;
                    percentage = Math.min(ratio * 92, 92);
                }
                
                const topPos = 5 + (index * step);

                // Plantilla HTML del corredor (usando comillas invertidas de JS)
                runnersHtml += `
                <div id="runner-${item.id}" 
                     class="runner absolute left-0 flex flex-col items-center z-20 group" 
                     style="top: ${topPos}%; left: ${percentage}%;">
                    <img src="${item.imagen}" 
                         class="h-10 w-10 object-contain drop-shadow-md transform -scale-x-100 transition-transform hover:scale-110"
                         onerror="this.src='https://img.icons8.com/emoji/48/000000/question-mark.png'">
                    <div class="opacity-0 group-hover:opacity-100 absolute -top-8 bg-black text-white text-[10px] px-2 py-1 rounded transition-opacity whitespace-nowrap z-50 pointer-events-none">
                        ${item.nombre}: ${item.inscritos}
                    </div>
                </div>`;

                leaderboardData.push({ ...item, ratio: ratio });
            });

            trackContainer.innerHTML = runnersHtml;

            // Ordenar y pintar tabla
            leaderboardData.sort((a, b) => b.inscritos - a.inscritos);

            let tableHtml = '';
            leaderboardData.forEach((item, index) => {
                const rank = index + 1;
                const percentText = Math.round(item.ratio * 100);
                
                let rowClass = "flex items-center justify-between p-1.5 rounded border-b border-gray-100 last:border-0 hover:bg-gray-50";
                let badgeClass = "bg-gray-100 text-gray-600";
                
                if (index === 0 && item.inscritos > 0) {
                    rowClass = "flex items-center justify-between p-1.5 rounded bg-yellow-50 border border-yellow-200 shadow-sm mb-1";
                    badgeClass = "bg-yellow-200 text-yellow-800 font-bold";
                }

                tableHtml += `
                <li class="${rowClass} flex-col items-stretch">
                    <div class="flex justify-between items-center mb-1">
                        <div class="flex items-center">
                            <span class="text-[10px] font-bold text-gray-400 w-4 text-center mr-1">${rank}췈</span>
                            <img src="${item.imagen}" class="w-4 h-4 mr-2 object-contain">
                            <span class="text-xs font-semibold text-gray-700 truncate max-w-[80px]">${item.nombre}</span>
                        </div>
                        <span class="text-[10px] px-1.5 rounded ${badgeClass}">${percentText}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-1">
                        <div class="bg-blue-500 h-1 rounded-full" style="width: ${percentText}%"></div>
                    </div>
                    <div class="text-[9px] text-gray-400 text-right mt-0.5">${item.inscritos} inscritos</div>
                </li>`;
            });

            leaderboardContainer.innerHTML = tableHtml;
        }
    </script>
</body>
</html>